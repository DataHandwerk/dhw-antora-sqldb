= [repo].[IndexReferencedReferencing]

== existing_properties

// tag::existing_properties[]
:ExistsProperty--antorareferencedlist:
:ExistsProperty--antorareferencinglist:
:ExistsProperty--has_execution_plan_issue:
:ExistsProperty--referencedobjectlist:
:ExistsProperty--sql_modules_definition:
:ExistsProperty--FK:
:ExistsProperty--AntoraIndexList:
:ExistsProperty--Columns:
// end::existing_properties[]

== RepoObject_guid

// tag::RepoObject_guid[]
6690291C-9D61-EB11-84DC-A81E8446D5B0
// end::RepoObject_guid[]

== SysObject_type

// tag::SysObject_type[]
V 
// end::SysObject_type[]

== SysObject_type_name

// tag::SysObject_type_name[]
view
// end::SysObject_type_name[]

== SysObject_id

// tag::SysObject_id[]
1234819461
// end::SysObject_id[]

== SysObject_modify_date

// tag::SysObject_modify_date[]
2021-07-14 19:36:08
// end::SysObject_modify_date[]

== AntoraColumnDetails

// tag::AntoraColumnDetails[]
[[column-referenced_index_guid]]
=== referenced_index_guid

[cols="d,m,m,m,m,d"]
|===
|
|referenced_index_guid
|uniqueidentifier
|NULL
|
|
|===

.Referenced Columns
--
* xref:repo.Index_virtual.adoc#column-referenced_index_guid[+repo.Index_virtual.referenced_index_guid+]
--

.Referencing Columns
--
* xref:repo.IndexReferencedReferencing_HasFullColumnsInReferencing.adoc#column-referenced_index_guid[+repo.IndexReferencedReferencing_HasFullColumnsInReferencing.referenced_index_guid+]
--


[[column-referenced_RepoObject_guid]]
=== referenced_RepoObject_guid

[cols="d,m,m,m,m,d"]
|===
|
|referenced_RepoObject_guid
|uniqueidentifier
|NULL
|
|
|===

.Referenced Columns
--
* xref:reference.RepoObject_reference_union.adoc#column-referenced_RepoObject_guid[+reference.RepoObject_reference_union.referenced_RepoObject_guid+]
--

.Referencing Columns
--
* xref:repo.IndexReferencedReferencing_HasFullColumnsInReferencing.adoc#column-referenced_RepoObject_guid[+repo.IndexReferencedReferencing_HasFullColumnsInReferencing.referenced_RepoObject_guid+]
--


[[column-referencing_RepoObject_guid]]
=== referencing_RepoObject_guid

[cols="d,m,m,m,m,d"]
|===
|
|referencing_RepoObject_guid
|uniqueidentifier
|NULL
|
|
|===

.Referenced Columns
--
* xref:reference.RepoObject_reference_union.adoc#column-referencing_RepoObject_guid[+reference.RepoObject_reference_union.referencing_RepoObject_guid+]
--

.Referencing Columns
--
* xref:repo.IndexReferencedReferencing_HasFullColumnsInReferencing.adoc#column-referencing_RepoObject_guid[+repo.IndexReferencedReferencing_HasFullColumnsInReferencing.referencing_RepoObject_guid+]
--


[[column-RowNumberInReferencing_Target]]
=== RowNumberInReferencing_Target

[cols="d,m,m,m,m,d"]
|===
|
|RowNumberInReferencing_Target
|int
|NULL
|
|
|===

.Description
--
the same index can be inherited several times into the same referenced object, if a source is used several times
for example
SELECT A_A = A.A, B_A = B.A from source_1 as A LEFT JOIN source_1 as B ON ... 
normaly these indexes should have different columns
--

.Referenced Columns
--
* xref:repo.Index_virtual.adoc#column-RowNumberInReferencing[+repo.Index_virtual.RowNumberInReferencing+]
--

.Referencing Columns
--
* xref:repo.IndexReferencedReferencing_HasFullColumnsInReferencing.adoc#column-RowNumberInReferencing_Target[+repo.IndexReferencedReferencing_HasFullColumnsInReferencing.RowNumberInReferencing_Target+]
--


[[column-source_index_guid]]
=== source_index_guid

[cols="d,m,m,m,m,d"]
|===
|
|source_index_guid
|uniqueidentifier
|NULL
|
|
|===

.Referenced Columns
--
* xref:repo.Index_union.adoc#column-index_guid[+repo.Index_union.index_guid+]
--

.Referencing Columns
--
* xref:repo.IndexReferencedReferencing_HasFullColumnsInReferencing.adoc#column-source_index_guid[+repo.IndexReferencedReferencing_HasFullColumnsInReferencing.source_index_guid+]
--


[[column-source_index_type]]
=== source_index_type

[cols="d,m,m,m,m,d"]
|===
|
|source_index_type
|tinyint
|NOT NULL
|
|
|===

.Referenced Columns
--
* xref:repo.Index_union.adoc#column-index_type[+repo.Index_union.index_type+]
--

.Referencing Columns
--
* xref:repo.IndexReferencedReferencing_HasFullColumnsInReferencing.adoc#column-source_index_type[+repo.IndexReferencedReferencing_HasFullColumnsInReferencing.source_index_type+]
--


// end::AntoraColumnDetails[]

== AntoraPkColumnTableRows

// tag::AntoraPkColumnTableRows[]






// end::AntoraPkColumnTableRows[]

== AntoraNonPkColumnTableRows

// tag::AntoraNonPkColumnTableRows[]
|
|<<column-referenced_index_guid>>
|uniqueidentifier
|NULL
|
|

|
|<<column-referenced_RepoObject_guid>>
|uniqueidentifier
|NULL
|
|

|
|<<column-referencing_RepoObject_guid>>
|uniqueidentifier
|NULL
|
|

|
|<<column-RowNumberInReferencing_Target>>
|int
|NULL
|
|

|
|<<column-source_index_guid>>
|uniqueidentifier
|NULL
|
|

|
|<<column-source_index_type>>
|tinyint
|NOT NULL
|
|

// end::AntoraNonPkColumnTableRows[]

== AntoraIndexList

// tag::AntoraIndexList[]

[[index-idx_IndexReferencedReferencing_1]]
=== idx_IndexReferencedReferencing++__++1

* IndexSemanticGroup: xref:index/IndexSemanticGroup.adoc#_no_group[no_group]
+
--
* <<column-referenced_RepoObject_guid>>; uniqueidentifier
* <<column-referencing_RepoObject_guid>>; uniqueidentifier
--
* PK, Unique, Real: 0, 0, 0


[[index-idx_IndexReferencedReferencing_2]]
=== idx_IndexReferencedReferencing++__++2

* IndexSemanticGroup: xref:index/IndexSemanticGroup.adoc#_index_guid[index_guid]
+
--
* <<column-source_index_guid>>; uniqueidentifier
--
* PK, Unique, Real: 0, 0, 0

// end::AntoraIndexList[]

== AntoraParameterList

// tag::AntoraParameterList[]

// end::AntoraParameterList[]

== AdocUspSteps

// tag::adocuspsteps[]

// end::adocuspsteps[]


== AntoraReferencedList

// tag::antorareferencedlist[]
* xref:reference.RepoObject_reference_union.adoc[]
* xref:repo.Index_union.adoc[]
* xref:repo.Index_virtual.adoc[]
// end::antorareferencedlist[]


== AntoraReferencingList

// tag::antorareferencinglist[]
* xref:repo.IndexReferencedReferencing_HasFullColumnsInReferencing.adoc[]
// end::antorareferencinglist[]


== exampleUsage

// tag::exampleusage[]

// end::exampleusage[]


== exampleUsage_2

// tag::exampleusage_2[]

// end::exampleusage_2[]


== exampleWrong_Usage

// tag::examplewrong_usage[]

// end::examplewrong_usage[]


== has_execution_plan_issue

// tag::has_execution_plan_issue[]
1
// end::has_execution_plan_issue[]


== has_get_referenced_issue

// tag::has_get_referenced_issue[]

// end::has_get_referenced_issue[]


== has_history

// tag::has_history[]

// end::has_history[]


== has_history_columns

// tag::has_history_columns[]

// end::has_history_columns[]


== is_persistence

// tag::is_persistence[]

// end::is_persistence[]


== is_persistence_check_duplicate_per_pk

// tag::is_persistence_check_duplicate_per_pk[]

// end::is_persistence_check_duplicate_per_pk[]


== is_persistence_check_for_empty_source

// tag::is_persistence_check_for_empty_source[]

// end::is_persistence_check_for_empty_source[]


== is_persistence_delete_changed

// tag::is_persistence_delete_changed[]

// end::is_persistence_delete_changed[]


== is_persistence_delete_missing

// tag::is_persistence_delete_missing[]

// end::is_persistence_delete_missing[]


== is_persistence_insert

// tag::is_persistence_insert[]

// end::is_persistence_insert[]


== is_persistence_truncate

// tag::is_persistence_truncate[]

// end::is_persistence_truncate[]


== is_persistence_update_changed

// tag::is_persistence_update_changed[]

// end::is_persistence_update_changed[]


== is_repo_managed

// tag::is_repo_managed[]

// end::is_repo_managed[]


== microsoft_database_tools_support

// tag::microsoft_database_tools_support[]

// end::microsoft_database_tools_support[]


== MS_Description

// tag::ms_description[]

// end::ms_description[]


== persistence_source_RepoObject_fullname

// tag::persistence_source_repoobject_fullname[]

// end::persistence_source_repoobject_fullname[]


== persistence_source_RepoObject_fullname2

// tag::persistence_source_repoobject_fullname2[]

// end::persistence_source_repoobject_fullname2[]


== persistence_source_RepoObject_guid

// tag::persistence_source_repoobject_guid[]

// end::persistence_source_repoobject_guid[]


== persistence_source_RepoObject_xref

// tag::persistence_source_repoobject_xref[]

// end::persistence_source_repoobject_xref[]


== pk_index_guid

// tag::pk_index_guid[]

// end::pk_index_guid[]


== pk_IndexPatternColumnDatatype

// tag::pk_indexpatterncolumndatatype[]

// end::pk_indexpatterncolumndatatype[]


== pk_IndexPatternColumnName

// tag::pk_indexpatterncolumnname[]

// end::pk_indexpatterncolumnname[]


== pk_IndexSemanticGroup

// tag::pk_indexsemanticgroup[]

// end::pk_indexsemanticgroup[]


== ReferencedObjectList

// tag::referencedobjectlist[]
* [reference].[RepoObject_reference_union]
* [repo].[Index_union]
* [repo].[Index_virtual]
// end::referencedobjectlist[]


== usp_persistence_RepoObject_guid

// tag::usp_persistence_repoobject_guid[]

// end::usp_persistence_repoobject_guid[]


== UspParameters

// tag::uspparameters[]

// end::uspparameters[]


== sql_modules_definition

// tag::sql_modules_definition[]
[source,sql]
----


/*
Was ist der Sinn dieser Sicht?

Es muss bedacht werden, dass der gleiche Quell-Index im Zielobjekt mehrere Vererbungen haben kann,
wenn die Quelle mehrfach verwendet wird und der Quell-Index somit auch mehrfach im Ziel vorhanden sein kann
Das ist so lange OK, wie es im referenced unterschiedliche Spalten sind.

Wir müssten noch irgendwo prüfen, ob die gleiche Spalten-Kombination aus verschiedenen Quellen geerbt wird
Und dann dürfte es den Index nur einmal geben, aber möglicherweise mit mehrfachen Quellen?
Oder brauchen wir nur eine Quelle und ignorieren einfach weitere Quellen?

repo.RepoObject_reference__union
fasst aber alle Referenzen zwischen Objekten zusammen, auch wenn es da mehrere Ausprägungen gibt

Wenn repo.Index__virtual AS i_v richtig gefüllt wird, dann müsste es in folgender Sicht auch eine Einträge mit Anz > 1 geben 

SELECT
       [source_index_guid]
     , [referenced_RepoObject_guid]
     , [referencing_RepoObject_guid]
     , COUNT(*) AS [Anz]
FROM
     repo.IndexReferencedReferencing AS T1
GROUP BY
         [source_index_guid]
       , [referenced_RepoObject_guid]
       , [referencing_RepoObject_guid]
ORDER BY
         [Anz] DESC

*/
CREATE View repo.IndexReferencedReferencing
As
--
Select
    i_s.index_guid             As source_index_guid
  , ror.referencing_RepoObject_guid
  , i_v.RowNumberInReferencing As RowNumberInReferencing_Target
  , i_s.index_type             As source_index_type
  , ror.referenced_RepoObject_guid
  , i_v.referenced_index_guid  As referenced_index_guid
From
    repo.Index_union                    As i_s --index source: index in referenced source object(s)
    Inner Join
        [reference].RepoObject_reference_union As ror
            On
            ror.referenced_RepoObject_guid = i_s.parent_RepoObject_guid

    Left Join
        repo.Index_virtual              As i_v
            On
            i_v.referenced_index_guid      = i_s.index_guid
            And i_v.parent_RepoObject_guid = ror.referencing_RepoObject_guid;

----
// end::sql_modules_definition[]


